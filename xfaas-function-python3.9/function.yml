name: python
# TODO: validate that image exists in remote repo
image: paulwie/xfaas-function-python3.9:latest
#image: paulwie/xfaas-spring-example:latest
#image: paulwie/openfaas-python:latest
deployRegistry: registry.hub.docker.com
# How to create namespaces
# - OpenFaaS (default namespace is openfaas-fn) https://docs.openfaas.com/reference/namespaces/
# TODO: only deploy function if namespace for target platform exists
namespace: default
scale:
    # Idle duration before scaling to zero. Default 1m. Valid units s (seconds), m (minutes)
    # Knative: https://knative.dev/docs/serving/autoscaling/scale-to-zero/#scale-to-zero-last-pod-retention-period (Default 0s)
    # OpenFaaS: https://docs.openfaas.com/architecture/autoscaling/ (Default 15m, But Scale to Zero only for OpenFaaS pro -> currently ignored)
    # Nuclio:
    # Fission: https://fission.io/docs/reference/crd-reference/ (idletimeout)
    scaleZeroDuration: 2m
    # Whether scale to zero or not (default is true)
    # Knative: always scales to zero, can just be configured globally (https://knative.dev/docs/serving/autoscaling/scale-to-zero/)
    # OpenFaaS: Scale to Zero only available for OpenFaaS Pro https://docs.openfaas.com/architecture/autoscaling/
    # Nuclio:
    # Fission:
    enableScaleToZero: true
    min: 1
    max: 20
#limits:
#    memory: 200Mi # Here we constrain the url-ping function to only use 40Mb of RAM at a maximum
#    cpu: 500m #100m which is equivalent to 1/10 of an Intel Hyperthread core.
#requests:
#    memory: 200Mi # Requests ensures the stated host resource is available for the container to use
#    cpu: 500m #100m which is equivalent to 1/10 of an Intel Hyperthread core.
platformSpecificConfigurations:
    nuclio:
        # Used to expose Nuclio functions. Use ClusterIP for production.
        #TODO: http-trigger creation will take a while -> Print this to the console
        serviceType: NodePort
    fission:
        # Currently it is only supported to deploy functions as container
        executorType: container
        # Fission does not create https automatically. Therefore, xfaas can be configured to do this automatically.
        # The function can then be accessed http://{FISSION-ROUTER}/{route}
        defaultHttpTrigger:
            # TODO: check if trigger already exists
            route: /node
